# 第五章 - 流复制和逻辑复制

## 概述

PostgreSQL流复制的体系架构可以用下图来表示：

![](d0052.svg)

在上图中，左边的大矩形框表示主库，右边的大矩形框表示备库。主库的用户发起的修改数据的事务(INSERT/DELETE/UPDATE)，相关的WAL记录会被写入到WAL文件中。这个大家已经非常熟悉了。在主库上有一个walsender的后端进程，会不断地读取WAL文件中的记录，通过TCP连接，传输给远端备库机器上的walreceiver进程。walreceiver进程收到来自主库的WAL记录后，会写入本地的WAL文件中。备库机器上还有一个startup进程，不断读取WAL文件中的WAL记录，把它们不断更新到数据文件上。


## 流复制

作为数据库的管理人员，掌握数据库的备份和各种条件下的恢复技能，是第一要务。

![](d0049.svg)


### 流复制的监控

作为数据库的管理人员，掌握数据库的备份和各种条件下的恢复技能，是第一要务。

![](d0051.svg)


