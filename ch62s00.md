# PostgreSQL的本地内存管理

本章深入介绍了PostgreSQL的本地内存管理。所谓本地内存，就是属于本进程所独有的普通内存，是通过malloc()进行分配和free()进行释放的，而不是我们在第X章介绍的共享内存。

我们知道，PostgreSQL是使用C语言开发的。C语言作为性能最高的系统开发语言之一(性能仅次于汇编语言)，它对内存的管理的基本思想是让程序员自己控制程序的内存管理。这带来了极大的灵活性，但是带来了大量由此衍生的问题。C语言程序员的水平参差不齐，导致如果没有很好的内存管理方法，C程序会出现大量bug。如何有效管理C程序的内存，是每一个C语言程序员必须面对的问题。

PostgreSQL作为高质量的数据库服务器软件，必须做到非常健壮，经受住长年累月不间断的运行。这对PostgreSQL内存的管理提出的非常高的要求。PostgreSQL和其它高质量C程序的基本思路是一样的，就是使用内存池技术统一管理本地内存的分配和释放。本章就是介绍PostgreSQL内存池的设计理念和关键设计细节。

C语言的初学者都知道，开发C语言应用软件，内存的申请是使用malloc()，内存的释放是使用free()。下面我们先来回顾一下这两个函数的基本使用和特点。

## malloc()和free()介绍

我们先来看一下如下一个简单的C程序：

我们可以看到

